<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROTOCOL: VOID</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    
    <style>
        :root {
            --bg-color: #050505;
            --terminal-green: #33ff33;
            --terminal-red: #ff3333;
            --terminal-amber: #ffcc00;
            --terminal-cyan: #00ccff;
            --terminal-dim: #444;
        }

        body {
            background-color: var(--bg-color);
            color: #e0e0e0;
            font-family: 'Fira Code', monospace;
            overflow: hidden;
            height: 100vh; /* Fallback */
            height: 100dvh; /* Dynamic viewport height for mobile browsers */
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* FX Layers */
        .scanlines {
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.2) 50%,
                rgba(0,0,0,0.2)
            );
            background-size: 100% 4px;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 50;
            opacity: 0.6;
        }
        
        .flicker {
            animation: flicker 0.15s infinite;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(18, 16, 16, 0.05);
            pointer-events: none;
            z-index: 49;
        }

        .glow-text { text-shadow: 0 0 4px currentColor; }
        
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Text Utilities */
        .txt-sys { color: #888; }
        .txt-success { color: var(--terminal-green); text-shadow: 0 0 5px rgba(51, 255, 51, 0.5); }
        .txt-error { color: var(--terminal-red); text-shadow: 0 0 5px rgba(255, 51, 51, 0.5); }
        .txt-warn { color: var(--terminal-amber); text-shadow: 0 0 5px rgba(255, 204, 0, 0.5); }
        .txt-item { color: var(--terminal-cyan); text-shadow: 0 0 5px rgba(0, 204, 255, 0.5); }
        .txt-nav { color: #d4d4d4; font-weight: bold; }
        .txt-choice { color: #fff; cursor: pointer; }
        .txt-choice:hover { text-decoration: underline; color: var(--terminal-green); }

        #output p { margin-bottom: 0.5rem; line-height: 1.4; }

        /* Documentation Scrolling */
        .doc-content {
            overflow-y: auto !important;
            overflow-x: hidden;
            max-height: 100%;
            -webkit-overflow-scrolling: touch;
        }
        
        .doc-content::-webkit-scrollbar {
            width: 3px;
        }
        
        .doc-content::-webkit-scrollbar-track {
            background: rgba(17, 17, 17, 0.5);
        }
        
        .doc-content::-webkit-scrollbar-thumb {
            background: rgba(136, 136, 136, 0.5);
            border-radius: 2px;
        }
        
        .doc-content::-webkit-scrollbar-thumb:hover {
            background: rgba(136, 136, 136, 0.8);
        }

        /* Map Styles */
        .map-cell { transition: all 0.3s ease; border: 1px solid #222; background: #0a0a0a; }
        .map-cell.active {
            border-color: var(--terminal-green);
            background-color: rgba(51, 255, 51, 0.1);
            color: var(--terminal-green);
            box-shadow: 0 0 8px rgba(51, 255, 51, 0.2);
        }

        /* Landing Page */
        #landing-page {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }
        
        /* Game Over Page */
        #game-over-page {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #050505;
            z-index: 101; /* Above landing page */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            opacity: 0;
            transition: opacity 1s ease-in;
        }
        #game-over-page.visible { opacity: 1; }
        
        .boot-btn {
            border: 1px solid var(--terminal-green);
            color: var(--terminal-green);
            padding: 10px 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 2rem;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(0,0,0,0.5);
        }
        .boot-btn:hover { background: var(--terminal-green); color: black; box-shadow: 0 0 15px var(--terminal-green); }

        .hidden { display: none !important; }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="flex flex-col md:flex-row h-screen max-w-7xl mx-auto border-x-0 md:border-x border-gray-800 shadow-2xl shadow-black relative overflow-hidden">

    <div class="scanlines"></div>
    <div class="flicker"></div>

    <!-- START SCREEN -->
    <div id="landing-page">
        <div class="max-w-2xl w-full">
            <h1 class="text-3xl md:text-6xl text-green-500 font-bold mb-6 md:mb-8 text-center glow-text tracking-widest break-words">PROTOCOL:<span class="text-red-500 ml-2 md:ml-4">VOID</span></h1>
            <div id="boot-text" class="font-mono text-xs md:text-base text-gray-400 space-y-2 md:space-y-4 h-48 md:h-64 overflow-hidden border-l-2 border-green-900 pl-4">
                <!-- Typewriter intro goes here -->
            </div>
            <div class="text-center">
                <button id="start-btn" class="boot-btn opacity-0 text-sm md:text-base">Initialize Link</button>
            </div>
        </div>
    </div>
    
    <!-- GAME OVER SCREEN -->
    <div id="game-over-page" class="hidden">
        <div class="max-w-3xl w-full text-center">
            <h1 class="text-2xl md:text-4xl text-gray-500 font-bold mb-2 tracking-widest">FINAL REPORT</h1>
            <div id="end-rating" class="text-6xl md:text-9xl font-bold mb-8 glow-text">RANK: ?</div>
            <div id="end-message" class="text-sm md:text-xl font-mono text-gray-300 mb-8 max-w-lg mx-auto leading-relaxed border-l-2 border-gray-700 pl-6 text-left"></div>
            <button id="restart-btn" class="boot-btn">SYSTEM RESET</button>
        </div>
    </div>

    <!-- GAME UI -->
    <!-- Sidebar -->
    <aside class="w-full md:w-80 bg-black border-b md:border-b-0 md:border-r border-gray-800 flex flex-col flex-shrink-0 p-3 md:p-4 z-10 font-bold tracking-wider relative h-auto max-h-[40vh] md:max-h-full md:h-full overflow-hidden md:overflow-visible">
        
        <!-- Header -->
        <div class="flex justify-between items-end border-b border-gray-800 pb-2 mb-2 flex-shrink-0">
            <div>
                <h1 class="text-base md:text-lg text-green-500 glow-text">PROTOCOL:<span class="text-red-500 ml-1">VOID</span></h1>
                <div class="text-[10px] text-gray-500">SESSION ID: <span id="session-id">8492-X</span></div>
            </div>
            <div class="text-[10px] md:text-xs text-red-500 animate-pulse">LOCKDOWN ACTIVE</div>
        </div>

        <!-- Sidebar Scroll Container for Mobile -->
        <div class="flex-grow flex flex-col md:flex-col overflow-y-auto md:overflow-visible min-h-0">
            
            <!-- Minimap -->
            <div class="mb-2 md:mb-4 flex-shrink-0">
                <h2 class="text-[10px] uppercase text-gray-500 mb-1 md:mb-2">Sector Map</h2>
                <!-- Map Grid: 5x5 grid - Main Hall is central hub, rooms positioned by actual connections -->
                <!-- Layout: Main Hall (row 3, col 3) is center. Rooms positioned relative to their connections -->
                <div class="grid grid-cols-5 gap-1 mb-2 font-mono text-[8px] md:text-[9px] text-center select-none max-w-[250px] md:max-w-none mx-auto md:mx-0">
                    <!-- Row 1: North area - Security (NW), Comm Hub (N of Research), Server (N), Medical (NE), Quarters (E of Medical) -->
                    <div id="map-security_office" class="map-cell p-1 text-gray-600 rounded" title="Security Office (NW of Main Hall)">SEC</div>
                    <div id="map-communications_hub" class="map-cell p-1 text-gray-600 rounded" title="Communications Hub (E of Security, N of Research Lab)">COMM</div>
                    <div id="map-server_room" class="map-cell p-1 text-gray-600 rounded" title="Server Room (N of Main Hall)">SERVER</div>
                    <div id="map-medical_bay" class="map-cell p-1 text-gray-600 rounded" title="Medical Bay (NE of Main Hall)">MED</div>
                    <div id="map-quarters" class="map-cell p-1 text-gray-600 rounded" title="Quarters (E of Medical Bay)">QTRS</div>
                    <!-- Row 2: Research Lab (N of Comm Hub, positioned between Comm Hub and Main Hall area) -->
                    <div></div>
                    <div id="map-research_lab" class="map-cell p-1 text-gray-600 rounded" title="Research Lab (S of Comm Hub, W of Main Hall)">LAB</div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <!-- Row 3: Central row - Engineering (W), Main Hall (center), Cryo (E) -->
                    <div id="map-engineering" class="map-cell p-1 text-gray-600 rounded" title="Engineering (W of Main Hall)">ENG</div>
                    <div></div>
                    <div id="map-main_hall" class="map-cell p-1 text-gray-600 rounded" title="Main Hall (Central Hub)">MAIN</div>
                    <div></div>
                    <div id="map-cryo_bay" class="map-cell p-1 text-gray-600 rounded" title="Cryo Bay (E of Main Hall)">CRYO</div>
                    <!-- Row 4: Empty -->
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <!-- Row 5: Docking Bay (S of Main Hall) -->
                    <div></div>
                    <div></div>
                    <div id="map-docking_bay" class="map-cell p-1 text-gray-600 rounded" title="Docking Bay (S of Main Hall)">DOCK</div>
                    <div></div>
                    <div></div>
                </div>
                <div class="flex justify-between text-[10px] bg-gray-900 p-1 rounded max-w-[200px] md:max-w-none mx-auto md:mx-0">
                    <span class="text-gray-400">LOC: <span id="status-loc" class="text-cyan-400">UNKNOWN</span></span>
                    <span class="text-gray-400">TURN: <span id="status-turn" class="text-yellow-500">0</span></span>
                </div>
                <div id="timer-display" class="hidden text-[9px] text-red-500 mt-1 text-center animate-pulse">
                    TIME: <span id="timer-value">60:00</span>
                </div>
            </div>

            <!-- Two Column Info (Side by side on mobile, stacked on desktop) -->
            <div class="flex-grow flex flex-row md:flex-col gap-2 md:gap-4 min-h-[100px] md:min-h-0 overflow-hidden">
                <!-- Inventory -->
                <div class="w-1/2 md:w-full flex flex-col overflow-hidden border border-gray-900 p-2 rounded min-h-0">
                    <h2 class="text-[10px] uppercase text-gray-500 mb-1 bg-black shrink-0">Inventory</h2>
                    <ul id="inventory-list" class="text-[10px] md:text-xs space-y-1 text-cyan-600 overflow-y-auto flex-1 min-h-0">
                        <li class="italic text-gray-700 opacity-50">Empty...</li>
                    </ul>
                </div>

                <!-- Documentation System -->
                <div class="w-1/2 md:w-full flex flex-col border border-gray-900 p-2 rounded bg-gray-900/20 min-h-0 flex-1">
                    <!-- Tabs -->
                    <div class="flex gap-1 mb-1 border-b border-gray-800 shrink-0">
                        <button class="doc-tab active text-[9px] px-2 py-1 bg-gray-800 text-amber-500" data-tab="characters">CHARS</button>
                        <button class="doc-tab text-[9px] px-2 py-1 text-gray-600 hover:text-amber-500" data-tab="evidence">EVID</button>
                        <button class="doc-tab text-[9px] px-2 py-1 text-gray-600 hover:text-amber-500" data-tab="scenes">SCENES</button>
                        <button class="doc-tab text-[9px] px-2 py-1 text-gray-600 hover:text-amber-500" data-tab="notes">NOTES</button>
                    </div>
                    <!-- Content Areas - Scrollable Container -->
                    <div class="flex-1 min-h-0 overflow-hidden">
                        <div id="doc-characters" class="doc-content h-full text-[10px] md:text-xs space-y-2 text-gray-400 font-normal overflow-y-auto pr-1" style="max-height: 100%;">
                            <div class="italic opacity-30">No characters documented yet.</div>
                        </div>
                        <div id="doc-evidence" class="doc-content hidden h-full text-[10px] md:text-xs space-y-2 text-gray-400 font-normal overflow-y-auto pr-1" style="max-height: 100%;">
                            <div class="italic opacity-30">No evidence documented yet.</div>
                        </div>
                        <div id="doc-scenes" class="doc-content hidden h-full text-[10px] md:text-xs space-y-2 text-gray-400 font-normal overflow-y-auto pr-1" style="max-height: 100%;">
                            <div class="italic opacity-30">No scenes documented yet.</div>
                        </div>
                        <div id="doc-notes" class="doc-content hidden h-full text-[10px] md:text-xs space-y-2 text-gray-400 font-normal overflow-y-auto pr-1" style="max-height: 100%;">
                            <div class="italic opacity-30">No data recorded.</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-2 md:mt-4 pt-2 border-t border-gray-800 flex-shrink-0">
                <div class="flex items-center justify-between">
                    <span class="text-gray-600 text-[10px]">EVIDENCE CHAIN</span>
                    <span id="evidence-count" class="text-lg md:text-xl text-red-500 font-mono glow-text">0/20</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Console -->
    <main class="flex-1 flex flex-col bg-opacity-95 bg-black z-10 relative overflow-hidden min-h-0">
        <!-- Output Log -->
        <div id="console-output" class="flex-grow overflow-y-auto p-3 md:p-6 font-mono text-sm md:text-base pb-4">
            <!-- Dynamic Content -->
        </div>

        <!-- Input Area -->
        <div class="p-3 md:p-4 bg-gray-900 border-t border-gray-800 flex-shrink-0">
            <form id="command-form" class="flex items-center gap-2">
                <span id="prompt-symbol" class="text-green-500 font-bold text-base md:text-lg">&gt;</span>
                <input 
                    type="text" 
                    id="command-input" 
                    class="flex-grow bg-transparent border-none outline-none text-green-400 font-mono placeholder-gray-700 focus:ring-0 text-sm md:text-base"
                    placeholder="Enter command..."
                    autocomplete="off"
                    autofocus
                >
                <button type="submit" class="px-3 py-1 md:px-4 bg-green-900/30 text-green-400 border border-green-800 hover:bg-green-800/50 text-[10px] md:text-xs uppercase tracking-widest transition-colors whitespace-nowrap">
                    SEND
                </button>
            </form>
            <div id="input-hint" class="text-[10px] text-gray-600 mt-1 pl-4 md:pl-6 truncate">Try: 'look', 'move [dir]', 'talk [name]', 'inspect [thing]'</div>
        </div>
    </main>

    <script type="module" src="/js/main.js"></script>
</body>
</html>